
&emsp;
# 寄存器（Rigister）
- 寄存器是GPU上运行速度最快的内存空间
- 是一个在核函数中声明，没有其他修饰符的自变量
- 通常存储在寄存器中
- 核函数声明的数组，如果数组的索引是常量，且能在编译时确定，那么数组也存储在寄存器中 
- 寄存器变量对于每个线程来说都是私有的，一个核函数通常使用寄存器来保存需要频繁访问的 `线程私有变量`
>生命周期
- 寄存器变量与核函数的生命周期相同。一旦核函数执行完毕，就不能对寄存器变量进行访问了。 

>寄存器与 SM
- 寄存器是一个在 SM 中由活跃线程束划分出的较少资源。在Fermi GPU中，每个线程限 制最多拥有63个寄存器。Kepler GPU将该限制扩展至每个线程可拥有255个寄存器。核函数中使用寄存器越少，在 SM 上就会有更多的常驻线程块。每个SM上并发线程块越多，使用率和性能就越高。 


>检查核函数使用的硬件资源情况
- 下面的命令会输出寄存器的数量、共享内存的字节数以及每个线程所使用的常量内存的字节数
    ```c++
    -Xptaxs -v,-abi=no
    ```

>Register 与 Local Memory
- 如果一个核函数使用了超过硬件限制数量的寄存器，则会用本地内存（Local Memory）替代多占用的寄存器。这种寄存器溢出会给性能带来不利影响
- nvcc 编译器使用启发式策略来最小化寄存器的使用，以避免寄存器溢出。
- 可以在代码中为每个核函数显式地加上下面这些帮助编译器进行优化：
    ```c++
    __global__ void
    __launch_bounds__(maxThreadsPerBlock, minBlocksPerMultiprocessor)
    kernel_function(参数1, 参数2, ...)
    {
        // 核函数代码
    }
    ```
    - maxThreadsPerBlock: 每个线程块可以包含的最大线程数，这个线程块由核函数来启动
    - minBlockPerMultiprocessor: 可选参数，指明了在每个 SM 中预期的最小的常驻线程块数量
